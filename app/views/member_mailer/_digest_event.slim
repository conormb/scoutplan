- presenter = EventPresenter.new(event: event, current_member: @member)

.item
  = magic_link_to \
    @member,
    [event.unit, event],
    class: "imminent-event",
    style: "line-height:150%;margin-bottom:1rem;color:#57534E;text-decoration:none;display:block;line-height:150%;padding-top:18px;" do

    div(style="font-size:18px;line-height:150%;")
      span(style="font-size:21px;font-weight:bold;")
        = event.title

      br
      <img style="height:1rem;margin-right:0.1rem;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD8AAABICAYAAABBeC2mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABw0lEQVR4nO2czUrDQBRGT+eHYMFKxZUVXCm+/+PoxoXuxELEQpl0cJGJ1tpGaJLR9t4D3czQzD0pzJ2WfhnRAe+dBa6AaRqaA08hVKsu1821lu1SkLXmDjgDTHqNgXGM8bXLdXOtZfZ9o/dukgrYZJLmemOotfaW/4VthQ7F3msNJX8QqLxUVF4qo22DqX1MgVOgyFpRvyyBN2AeQlVuTn6T996NgRnQa5/+J5TAcwjVohn4POEl8Vvg5A8Ky0EBnFtryhhjgCS/Jt7puHsAGNZuQLPhzTh+8QZL7YtNm9vl39aTncJa8274+ooojamhbmcSOTUcdh/vQiH6hKfyUlF5qai8VFReKq5lrgyheshWyUB4727Y8eOM6E9e5aWi8lJReamovFRUXioqLxWVl4rKS0XlpaLyUlF5qai8VFReKiovFZWXispLReWl0ibf9n+dQ2Knh6GOX21j7L27GKaePKT6dwWNlyPv3TXQJrkAqt4rGx5He8L6xVE/gaBNPmccPCdzk5KGP9KGR04ZQlU2G94z0PtzLv4pK2rfOksXYwzWmhI457jb3wq4byKln0HCtRtQcJyhoxJ4XM/Sik5RfwDxL2V//XlVeQAAAABJRU5ErkJggg==" />      
      = presenter.short_dates_to_s

      - if event.location.present?
        br
        <img style="height:1rem;margin-right:0.5rem;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAABICAYAAAC9bQZsAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAydpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDcuMS1jMDAwIDc5LmIwZjhiZTkwLCAyMDIxLzEyLzE1LTIxOjI1OjE1ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjMuMiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4REE2QjQ3OUIwOEUxMUVDQkYwQkE1MkZCRUFBNkEwRiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo4REE2QjQ3QUIwOEUxMUVDQkYwQkE1MkZCRUFBNkEwRiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjhEQTZCNDc3QjA4RTExRUNCRjBCQTUyRkJFQUE2QTBGIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjhEQTZCNDc4QjA4RTExRUNCRjBCQTUyRkJFQUE2QTBGIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+E3VCygAABdFJREFUeNrc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" />
        = event.location

      - if event.short_description.present?
        br
        span(style="color:#78716C;")
          = event.short_description

  - if event.requires_rsvp
    - family_member_ids = @member.family.map(&:id)
    - family_rsvps = event.rsvps.where("unit_membership_id IN (?)", family_member_ids)
    - if family_rsvps.count.positive?
      - family_rsvps.group_by(&:response).each do |response, rsvps|
        - members = rsvps.map(&:member)
        - names = members.map{ |member| member == @member ? "You" : member.display_first_name }
        div(style="margin-bottom:0.5rem;")
          - if response == "accepted"
            div(style="font-weight:600;color:#0891B2;font-size:18px;")
              <img style="height:1rem;margin-right:0.3em;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAABYlAAAWJQFJUiTwAAAD8klEQVR4nOWczXniMBCG3/BsA04JpASnBFICKQFKMCXAcY+khHDdW1xCXEIoYV3C7kFSMIp/JHtsJPxdIATr52UkjTRjP/D7DxMrBVZAot+bzxLreyVQ6PeF/juvfDaJfk1QxxJYoyCsPa5LUCCpvBqdUKBOwHloA9v0MKIFbVBA7M5JK0eBehuj8IVweQmQAX+BI+PDQddx1HVm/ByqgyQJKAO+gD3CjXRUouv+0m0RkQSgFfDJ7cDYMqA+EbDgoYD2wAeX1Sgkpai27YcU0hfQEvULiZnyiMpQbV32ubgPoFRXGKLVNKl3m30BbXRFIcw1vkpQbd/4XOQDaINaTmPXEQ9IroDuBY6RMyQXQCn3BcfoiMOc1AVoiVoq71UfdKxuXYDeiXNCdlWC6mOj2gDtiWsp76uUFmeyCdCKOJxAKWU0bEuaAA1yzyNVbZ/rAGXMY2jZSqkZNTagpO5LM9KP8yQb0Mb+wsyUYDmQNqA5W4/RFYMqoLlbj9GVFVUB+UQcQtEJeAEe9OtJqNxvFgbQkmkO2CW1BV5RUQ306yuwEyh7hd6CGECxWc+W5jDPAZlY2RougGLye9rgGOUd/3dRCvFZkAscKX1bUCxzjw8cqT6lC+IYXj5wMnpGMGq0WhC+7+MDZ4PsRjsJ3YJ84UgfDafSyQsg57zdGg6g0l/+CZa3Q/khtnw7EAQcoJS0oDP1cEB1dutYTihwQM9BUuoaSi6QQoIDyCdQdakNUnBwQBaQqzdeBylIOCALaIn7gVsVUrBw0JO0xMbOaI97YsAb8Ey4cACKMeYgn+wJ15znmyVPLBgnMdsrxaRDt8wsKRaoDPYxJAHp1mk35VgWZDQE0q3hAOTSk3Sd+kAKAQ5UJmmpaECTfCCFAucEFz9oijtoXCCFAgc0k6ksyKgNUkhwwLKgM+PPRUZHVFZX9V6xd8KCk6NDR9X7xU5Md4C/JuxIyveIqnrSb4znE8Wkksr2x95qNB14zUlXDGxAc7eiK+uBn4BK5m1FBywDqdvNH5j4zuJAVFBjHE3HHRIpJLGpts9NgHLmNdQONPiBbQdmO+Yx1ApaRkzXieIr972qlag+NqoL0BkVPr5XvdCRjeZyJl3gHhWNSVscphDXQ3uf0HEMcg41+UQ17gWSVxqfb9jHxLJinLhL/OJwQL/IaqEriskF6N3mvoHDs64wBmfygGprr9zpoZHVHWqpDNGaClTbBm2bJELPOeoX2hHG3FSi2vKMwDGyZGz+ADxxO1AGzBOCQ186ecGcJz2iltMpAgG5ruuRmvOcoRrzGWZGfR/y1qbJHvI2xVPw7OTOFZfHAqaVz+pkLNA8JrBguvAUAP8BkCHayCBSg8QAAAAASUVORK5CYII=" />
              = [presenter.grammatical_list(names), presenter.substantive_verb(names), "going"].join(" ")
          - elsif response == "declined"
            div(style="font-weight:600;color:#EF4444;font-size:18px;")
              <img style="height:1rem;margin-right:0.3em;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAACXBIWXMAABYlAAAWJQFJUiTwAAADc0lEQVR4nO2c3U3jQBRGT6I04BZCCXnnAYUSoISkBCgBSkhKWEpYStiUsLRgiQbYB/uKJPhnZnzvzNjeI1kiCI3NSTKe+91JFp93txhRAA/AFtgAa+XxP4AT8A68AaXy+AAsjAQ91UdhMXgDJfAMHLUHXmoPCByAF+LJoT7XoT5U0RRUAH+AneKYvuzqa1B7crQEFcBvqrkmNRuqa1GRpCEoJzmCmqShgnKUI6hIGiIoZznCYEmhgsYgRxgkKUTQmOQIwZJ8BY1RjhAkyUfQmOUI3pJcBU1BjrABfrn+sYugKckRtjiWJX2CpihH2OEgqUvQlOUIvZLaBM1BjtApqUnQnOQIrZKuBc1RjtAo6VrQXOUIPySdCzowbznChSQR9ETaJDA3dvXB4vPutgD+EjdDHgMlcLOias1YyympWjRQvY1Dz6c1jgsF8LCiWnZb8g488t23Cr1TvgF7hXF82C6NT1ByKUd+d8/3K8GFY8s4j0MvsIfNEv2O5zknmjuePpKOVK+cJj6oXqFWrC0ah664SOqSEwVrQX0TaZckFzlrjOdQa0EykfpKcpFT4BF8hbKyPgHfMec97TswRNJL/dhFTpSyaPF5d/tlfZKaE92SoPrH+7axRC2oY07SLoF5VnIgriAY1sRLEsWkuM2HSEqWU6VaB/lIShripVwotq2yrzkvUKOTSpDvCnmPwf5DF1IICi0fkkiKLWhobRVdUkxBruVDH89EnJNiCfKprQ6EF7jqxBAkSWAXcivfUoXlIQWuCdaCSsIKT9eyxDpRNBfUt9bpWgS6SLJOFJMuFF1WyKqbwkNYUj0LVrQlij7lQ5ck60TxY4ntRCcizhsDa/xrK5F0PY51onhaUb2HHwxPsqHq3MpcEfqMa43jw/v/1nM7JXCzrH94TXwxOfIMlHIXeyVRtZwpx/q4uM3vSZi7ZMRFWXS9DopW42TKj5rxWlDUQjAzGgvqppX0HCW1pg1tpcacJHVGMV212Bwk9eZUfcXqlCU5xb8u1fwUJTln465xx5QkeTUOfPIgkfTme0UZ4d1V8Q3MJOYcY1kS1HIKTRSTdToDCe7HDYlcxyJpULNyaCadu6TBu2Q1QvtcJalsIdbqauQmSW1/tWbbJxdJqpvPtftiqSWp78y3aBzuufxUTgykxa3+sQWrb8GDiXxN4D9/0uGRO7zCXwAAAABJRU5ErkJggg==" />
              = [presenter.grammatical_list(names), presenter.substantive_verb(names), "not going"].join(" ")

    - if @member.adult?
      div(style="text-align:center;margin-top:1rem;margin-bottom:1.5rem;")
        - if !event.rsvp_open?
          = "RSVP is Closed"
        - elsif family_rsvps.count.positive?
          = magic_link_to @member,
            "Change RSVP",
            unit_event_edit_rsvps_url(event.unit, event),
            class: "rsvp-change-link",
            style: "border:1px solid rgb(0,0,0,0.5);color:rgb(0,0,0,0.5);display:inline-block;padding:0.5rem 3rem;border-radius:4px;text-align:center;text-decoration:none;font-weight:700;letter-spacing:1px;text-transform:uppercase;"

        - else
          = magic_link_to @member,
            "RSVP Needed",
            unit_event_edit_rsvps_url(event.unit, event),
            class: "rsvp-needed-link",
            style: "background:#E66425;border:1px solid #E66425;color:white;display:inline-block;padding:0.5rem 3rem;border-radius:4px;text-align:center;text-decoration:none;font-weight:700;letter-spacing:1px;text-transform:uppercase;"
