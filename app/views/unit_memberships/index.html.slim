= turbo_frame_tag('member_list')
  .w-full.mx-auto
    = render partial: 'unit_memberships/partials/index/header'
    = form_tag bulk_update_unit_members_path(@unit), id: 'bulk_edit_form'
      table.w-full
        thead
          tr
            th.selection.text-left.text-black
              = check_box_tag 'all_visible_events', 'on', false, class: 'form-check-input', id: 'select_all_members_checkbox'
            th.member-type.text-left.px-2.py-2.text-black
            th.text-left.px-2.py-2.text-black = t('members.name')
            th.role.text-left.px-2.py-2.text-black
            th.text-left.px-2.py-2.text-black.whitespace-nowrap = t('members.parent_guardian')
            th.text-left.px-2.py-2.text-black = t('members.children')

        tbody
          = render @unit_memberships

// empty turbo frame to be populated by a Member modal as needed
= turbo_frame_tag 'member'

= render partial: 'events/partials/styles'

scss:
  th.selection, td.selection {
    display: none;
  }

  #bulk_edit_options {
    display: none;
  }

  body.bulk-edit {
    th.selection, td.selection {
      display: table-cell;
    }

    #regular_options {
      display: none;
    }

    #bulk_edit_options {
      display: inline-block;
    }
  }

  tr.member-inactive {
    td a {
      text-decoration: line-through;
    }
  }

  td.fit-width {
    width: 1%;
    white-space: nowrap;
  }

  tr.member-inactive {
    display: none;
  }

  th.status, td.status {
    display: none;
  }

  body.showing-inactive-members {
    tr.member-inactive {
      display: table-row;
    }

    th.status, td.status {
      display: table-cell;
    }

    #show_inactive_members_link .menu-glyph-wrapper {
      display: inline;
    }
  }

 .collapse-anim-off {
    -webkit-transition: none;
    transition: none;
  }

javascript:
  // BULK EDIT FACILITY

  // 'Select All' checkbox
  document.querySelector('#select_all_members_checkbox').addEventListener('click', function(event) {
    const checked = this.checked;
    document.querySelectorAll('.bulk-publish-checkbox').forEach(function (elem) {
        elem.checked = checked && elem.offsetParent !== null;
    });
    validateBulkEditState();
  });

  // enter bulk edit mode by adding a body class
  document.querySelector('#bulk_edit_link').addEventListener('click', function(event) {
    document.body.classList.toggle('bulk-edit');
    event.preventDefault();
  });

  // exit bulk edit mode by removing the same body class
  document.querySelector('#cancel_bulk_edit').addEventListener('click', function(event) {
    document.body.classList.remove('bulk-edit');
    event.preventDefault();
  });

  // wire up each checkbox to validate the screen and update the checked count
  document.querySelectorAll('.bulk-edit-checkbox').forEach(function(elem) {
    elem.addEventListener('click', function(event) {
      validateBulkEditState();
      event.stopPropagation();
    })
  });

  // wire up the bulk edit Apply button
  document.querySelector('#execute_bulk_edit_button').addEventListener('click', function(event) {
    document.querySelector('#bulk_edit_form').submit();
    event.preventDefault();
  });

  // toggle inactive members
  document.querySelector('#show_inactive_members_link').addEventListener('click', function(event) {
    document.body.classList.toggle('showing-inactive-members');
    event.preventDefault();
  });

  var bulkEditExecuteButton;
  var originalBulkEditExecuteButtonCaption;

  // capture the button state at the outset so we can restore it if need be
  document.addEventListener("DOMContentLoaded", function() {
    bulkEditExecuteButton = document.querySelector('#execute_bulk_edit_button');
    originalBulkEditExecuteButtonCaption = bulkEditExecuteButton.innerText;
  });

  // called each time a checkbox is changed
  function validateBulkEditState() {
    // tally up checked count
    const checkedCount = document.querySelectorAll('td.selection input:checked').length;

    // enable execute button
    bulkEditExecuteButton.disabled = (checkedCount == 0);

    // update execute button caption
    bulkEditExecuteButton.innerText = originalBulkEditExecuteButtonCaption + (checkedCount == 0 ? '' : ' (' + checkedCount + ')');
  }

- if params[:member_id] && false
  javascript:
    document.querySelector('#member_#{params[:member_id]}_row').querySelector('a').click();